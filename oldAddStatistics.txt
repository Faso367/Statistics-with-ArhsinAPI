DO $$
DECLARE
    MyRow RECORD;
    MyRow2 RECORD;
    MyRow3 RECORD;
    MyRow4 RECORD;
BEGIN
FOR MyRow IN SELECT * FROM "UniqueTypes" LOOP
    INSERT INTO "TypeStatistics" ("type", "count_", "year")
    SELECT 
    MyRow.type,
    COUNT("EquipmentInfoPartitioned"."typeId"),
    "year"
    FROM 
    "EquipmentInfoPartitioned"
    WHERE 
    "typeId" = MyRow.id
    GROUP BY
    "year", MyRow.id;
END LOOP;

FOR MyRow2 IN SELECT * FROM "UniqueTypeNames" LOOP
    INSERT INTO "TypeNameStatistics" ("typeName", "count_", "year")
    SELECT 
    MyRow2."typeName",
    COUNT("EquipmentInfoPartitioned"."typeNameId"),
    "year"
    FROM 
    "EquipmentInfoPartitioned"
    WHERE 
    "typeNameId" = MyRow2.id
    GROUP BY
    "year", MyRow2.id;
END LOOP;

FOR MyRow3 IN SELECT * FROM "UniqueModifications" LOOP
    INSERT INTO "ModificationStatistics" ("modification", "count_", "year")
    SELECT 
    MyRow3.modification,
    COUNT("EquipmentInfoPartitioned"."modificationId"),
    "year"
    FROM 
    "EquipmentInfoPartitioned"
    WHERE 
    "modificationId" = MyRow3.id
    GROUP BY
    "year", MyRow3.id;
END LOOP;


FOR MyRow4 IN SELECT * FROM "UniqueRegisterNumbers" LOOP
    INSERT INTO "RegisterNumberStatistics" ("registerNumber", "count_", "year")
    SELECT
    MyRow4.modification,
    COUNT("EquipmentInfoPartitioned"."registerNumberId"),
    "year"
    FROM 
    "EquipmentInfoPartitioned"
    WHERE 
    "registerNumberId" = MyRow4.id
    GROUP BY
    "year", MyRow4.id;
END LOOP;
END $$;